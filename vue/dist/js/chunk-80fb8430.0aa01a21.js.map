{"version":3,"sources":["webpack:///./src/views/BookDetail.vue","webpack:///./src/views/BookDetail.vue?e4ac","webpack:///./src/views/BookDetail.vue?8e7b"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","_createElementVNode","style","_hoisted_2","src","$data","book","imgHref","alt","_hoisted_4","_hoisted_5","_toDisplayString","name","_hoisted_6","author","innerHTML","intro","Date","publishYear","getFullYear","pages","_Fragment","_renderList","bookInstances","instance","key","barcode","_hoisted_8","location","status","_createBlock","_component_el_button","type","onClick","$event","$options","borrowBook","_cache","disabled","addcomment","comments","commentItem","readerId","_hoisted_9","_hoisted_10","content","_hoisted_11","time","_component_el_dialog","dialogVisible","title","width","footer","_withCtx","_hoisted_12","pub_comment","_component_el_form","model","form","label-width","_component_el_form_item","label","_component_el_input","model-value","autosize","minRows","maxRows","data","ISBN","publisher","userId","bookId","methods","console","log","response","request","get","this","error","post","params","ElMessage","success","search1","records","alert","mounted","$route","id","userData","sessionStorage","getItem","user","JSON","parse","fetchBookDetail","fetchBookInstances","fetchComments","__exports__","render"],"mappings":"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","file":"js/chunk-80fb8430.0aa01a21.js","sourcesContent":["<template>\r\n  <div class=\"page-container\">\r\n    <!-- 第一张卡片：书籍详细信息 -->\r\n    <el-card class=\"book-card\">\r\n      <h2 style=\"padding: 10px\">图书详情</h2>\r\n      <div class=\"book-content\">\r\n        <!-- 书籍封面 -->\r\n        <img :src=\"book.imgHref\" alt=\"书籍封面\" class=\"book-image\" />\r\n\r\n        <!-- 书籍信息 -->\r\n        <div class=\"book-text\">\r\n          <h3 class=\"book-name\">{{ book.name }}</h3>\r\n          <p class=\"book-author\">{{ book.author }}</p>\r\n          <p>简介：<span v-html=\"book.intro\"></span></p>\r\n          <p>出版年份：{{ new Date(book.publishYear).getFullYear() }}</p>\r\n          <p>页数：{{ book.pages }}</p>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 第二张卡片：馆藏信息 -->\r\n    <el-card class=\"book-card\" style=\"margin-top: 40px;\">\r\n      <h2 style=\"padding: 10px\">馆藏信息</h2>\r\n\r\n      <div v-for=\"instance in bookInstances\" :key=\"instance.barcode\" class=\"book-content bookinstance-borrow\">\r\n\r\n          <div class=\"book-text\">\r\n            <p><strong>馆藏地点：</strong>{{ instance.location }}</p>\r\n            <p><strong>馆藏编号：</strong>{{ instance.barcode }}</p>\r\n          </div>\r\n          <!-- 借阅按钮 -->\r\n          <el-button v-if=\"instance.status == 1\" type=\"primary\" @click=\"borrowBook(instance)\" class=\"borrow-btn\">借阅</el-button>\r\n        <el-button  v-else type=\"primary\" @click=\"borrowBook(instance)\" class=\"borrow-btn\" :disabled=\"true\">已借出</el-button>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 第三张卡片：用户评论 -->\r\n    <el-card class=\"book-card\" style=\"margin-top: 40px;position: relative;\">\r\n\r\n      <h2 style=\"padding: 10px\">用户评论</h2>\r\n      <!-- 右上角按钮 -->\r\n      <el-button\r\n          type=\"primary\"\r\n          @click=\"addcomment\"\r\n          style=\"position: absolute; top: 10px; right: 10px;\">\r\n        添加评论\r\n      </el-button>\r\n\r\n      <div v-for=\"commentItem in comments\" :key=\"commentItem.readerId\" class=\"book-content\">\r\n        <div class=\"book-text comment-box\">\r\n          <div class=\"comment-content\">\r\n            <p><strong></strong>{{ commentItem.content }}</p>\r\n          </div>\r\n          <div class=\"comment-meta\">\r\n            <p><strong>读者ID：</strong>{{ commentItem.readerId }}</p>\r\n            <p><strong>评论时间：</strong>{{ commentItem.time }}</p>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </el-card>\r\n    <el-dialog v-model=\"dialogVisible\" title=\"新闻发布\" width=\"30%\">\r\n      <el-form :model=\"form\" label-width=\"120px\">\r\n        <el-form-item label=\"发表你的看法:\">\r\n          <el-input model-value=\"请输入你想说的话....\" type=\"textarea\" style=\"width: 80%\" v-model=\"form.content\" :autosize=\"{ minRows: 1, maxRows: 10 }\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"pub_comment\">确 定</el-button>\r\n      </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from \"vuex\"; // 如果使用 Vuex 进行状态管理\r\nimport request from \"@/utils/request\";\r\nimport {resolveComponent} from \"vue\";\r\nimport {ElMessage} from \"element-plus\"; // 如果你使用 axios 来发起请求\r\n\r\nexport default {\r\n  name: \"LatestBookDetail\",\r\n  data() {\r\n    return {\r\n      book: {\r\n        ISBN: \"\",\r\n        name: \"\",\r\n        author: \"\",\r\n        publisher: \"\",\r\n        intro: \"\",\r\n        imgHref: \"\",\r\n        publishYear: \"\",\r\n        pages: \"\",\r\n      },\r\n      userId: \"\",\r\n      bookInstances: [],\r\n      comments: [],\r\n      dialogVisible: false ,\r\n      form: {},\r\n      bookId: \"\"\r\n    };\r\n  },\r\n  methods: {\r\n    async fetchBookDetail(bookId) {\r\n      console.log(\"加载书籍\");\r\n      try {\r\n        const response = await request.get(`/book/${bookId}`);\r\n        if (response.data) {\r\n          this.book = response.data[0];\r\n        }\r\n      } catch (error) {\r\n        console.error(\"获取图书详情失败:\", error);\r\n      }\r\n    },\r\n    async pub_comment(){\r\n      try{\r\n        console.log(this.form.content)\r\n        const response = await request.post(\"/comment/pub\",null,{\r\n          params: {\r\n            userId: this.userId,\r\n            content: this.form.content,\r\n            bookId: this.bookId\r\n          }\r\n        })\r\n        ElMessage.success(\"发表成功!!!\");\r\n      }catch (error){\r\n        console.log(error);\r\n      }\r\n      this.dialogVisible = false;\r\n\r\n    },\r\n    async fetchBookInstances(bookId) {\r\n      try {\r\n        const response = await request.get(\"/bookinstance\", {\r\n          params: { search1 : bookId },\r\n        });\r\n        if (response.data) {\r\n          this.bookInstances = response.data.records;\r\n        }\r\n      } catch (error) {\r\n        console.error(\"获取图书馆藏实例失败:\", error);\r\n      }\r\n    },\r\n    async fetchComments(bookId) {\r\n      try {\r\n        const response = await request.get(\"/comment/abook\", {\r\n          params: { bookId },\r\n        });\r\n        if (response.data) {\r\n          this.comments = response.data.records;\r\n        }\r\n      } catch (error) {\r\n        console.error(\"获取用户评论失败:\", error);\r\n      }\r\n    },\r\n    async addcomment(){\r\n      this.dialogVisible = true;\r\n      this.form = {}\r\n    },\r\n    async borrowBook(instance) {\r\n      try {\r\n        const response = await request.post(\"/LendRecord/borrow\", instance, {\r\n          params:{\r\n            userId: this.userId,\r\n          }\r\n        });\r\n        if (response.data.success) {\r\n          alert(`成功借阅《${this.book.name}》`);\r\n        } else {\r\n          alert(\"借阅失败，请稍后再试。\");\r\n        }\r\n      } catch (error) {\r\n        console.error(\"借阅图书失败:\", error);\r\n        alert(\"借阅失败，请稍后再试。\");\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    const bookId = this.$route.params.id; // Vue 2 使用 this.$route 访问路由参数\r\n    this.bookId = bookId;\r\n    const userData = sessionStorage.getItem(\"user\");\r\n    const user = JSON.parse(userData);\r\n    this.userId = user.id;\r\n\r\n    this.fetchBookDetail(bookId);\r\n    this.fetchBookInstances(bookId);\r\n    this.fetchComments(bookId);\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* 同 Vue 3 的样式 */\r\n.page-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  margin: 0;\r\n  padding-top: 40px;\r\n}\r\n\r\n.book-card {\r\n  width: 80%;\r\n  max-width: 1200px;\r\n  box-sizing: border-box;\r\n  padding: 10px;\r\n  background-color: #f9f9f9;\r\n  border-radius: 8px;\r\n}\r\n\r\n\r\n.book-content {\r\n  display: flex;\r\n  gap: 20px;\r\n  line-height: 1.5;\r\n}\r\n\r\n\r\n\r\n.book-image {\r\n  width: 150px;\r\n  height: 220px;\r\n  object-fit: cover;\r\n  border-radius: 8px;\r\n}\r\n.borrow-btn{\r\n  margin-top: 7px;\r\n}\r\n.book-text {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  position: relative;  /* 为了定位内部元素 */\r\n  gap: 10px;  /* 控制子元素之间的间距 */\r\n}\r\n.comment-box{\r\n  padding-bottom: 20px;\r\n  border-bottom: 1px solid #3a8ee6;\r\n}\r\n\r\n.comment-content {\r\n  flex: 1;\r\n}\r\n\r\n.comment-meta {\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  text-align: right;\r\n  font-size: 12px;\r\n  color: #888;\r\n}\r\n\r\n.bookinstance-borrow{\r\n  margin-bottom: 5px;\r\n}\r\n.bookinstance-borrow:hover{\r\n  background-color: lightskyblue;\r\n  border-color: dodgerblue;\r\n}\r\n.book-name {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.book-author {\r\n  font-size: 18px;\r\n  color: #333;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.book-intro {\r\n  font-size: 14px;\r\n  color: #666;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.el-button {\r\n  align-self: flex-start;\r\n}\r\n</style>\r\n","import { render } from \"./BookDetail.vue?vue&type=template&id=063b89ad&scoped=true\"\nimport script from \"./BookDetail.vue?vue&type=script&lang=js\"\nexport * from \"./BookDetail.vue?vue&type=script&lang=js\"\n\nimport \"./BookDetail.vue?vue&type=style&index=0&id=063b89ad&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Code\\\\Vue-Springboot-Library\\\\vue\\\\node_modules\\\\.store\\\\vue-loader@16.8.3\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-063b89ad\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/.store/mini-css-extract-plugin@0.9.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/.store/css-loader@3.6.0/node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/.store/vue-loader@16.8.3/node_modules/vue-loader/dist/stylePostLoader.js!../../node_modules/.store/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/.store/cache-loader@4.1.0/node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/.store/vue-loader@16.8.3/node_modules/vue-loader/dist/index.js??ref--1-1!./BookDetail.vue?vue&type=style&index=0&id=063b89ad&scoped=true&lang=css\""],"sourceRoot":""}